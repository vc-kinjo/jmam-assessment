# プロジェクト・タスク管理システム 要件定義書

## 1. システム概要

### 1.1 目的
プロジェクト毎のタスク管理とガントチャートによる視覚的管理を提供し、MS-PROJECT、Redmine、Backlogと同様の機能を持つWebアプリケーションを開発する。

### 1.2 システム特徴
- BFFアーキテクチャによるスケーラブルな構成
- ガントチャートによる視覚的プロジェクト管理
- テンプレート機能による類似プロジェクトの効率的な作成
- 階層化されたタスク管理（サブタスク無制限）
- イナズマ線による進捗可視化

## 2. 技術要件

### 2.1 システム構成
- **フロントエンド**: React, Next.js (TypeScript)
- **BFF**: Python, FastAPI
- **バックエンド**: Python, FastAPI  
- **データベース**: PostgreSQL
- **通信方式**: フロントエンド-BFF間は全てPOST通信

### 2.2 非機能要件
- レスポンシブデザイン対応
- セキュアな認証・認可機能
- ファイルアップロード対応
- PDF/Excel出力機能
- メール通知機能

## 3. ユーザー要件

### 3.1 利用者種別と権限

#### 3.1.1 システム管理者
- **権限範囲**: システム設定、全ユーザー管理、全プロジェクト管理
- **機能**:
  - 全ユーザーの作成・編集・削除
  - 全プロジェクトへのアクセス
  - システム設定の管理
  - 利用統計の確認

#### 3.1.2 プロジェクト管理者
- **権限範囲**: 担当プロジェクト内の全操作権限
- **機能**:
  - プロジェクトの作成・編集・削除
  - プロジェクトメンバーの管理
  - タスクの作成・編集・削除
  - 進捗レポートの作成
- **設定**: 複数人設定可能

#### 3.1.3 プロジェクトメンバー
- **権限範囲**: 参加プロジェクトのみ参照・操作可能
- **機能**:
  - 担当タスクの編集
  - タスクの状態更新
  - コメント・ファイル添付
  - 自分の作業時間記録

## 4. 機能要件

### 4.1 認証・ユーザー管理機能

#### 4.1.1 ログイン機能
- ユーザー名/パスワードによる認証
- セッション管理
- ログアウト機能

#### 4.1.2 ユーザー管理機能（管理者用）
- **登録項目**:
  - ユーザー名（必須、ユニーク）
  - パスワード（必須、暗号化）
  - 氏名（必須）
  - ふりがな
  - メールアドレス（必須、ユニーク）
  - 電話番号
  - 会社名
  - 所属部署
  - 権限レベル（一般/管理者）

#### 4.1.3 プロフィール編集機能（一般用）
- ログインユーザーの情報編集
- パスワード変更機能

### 4.2 プロジェクト管理機能

#### 4.2.1 プロジェクト作成機能
- **新規作成**:
  - プロジェクト名（必須）
  - 開始日（必須）
  - 終了予定日（必須）
  - プロジェクト責任者（必須）
  - 参加メンバー設定
  - プロジェクトカテゴリ（テンプレート用）

- **テンプレートからの作成**:
  - プロジェクトカテゴリ選択
  - 過去プロジェクトからのタスク自動生成
  - 生成されたタスクの編集・調整

#### 4.2.2 プロジェクト一覧・ダッシュボード
- 参加プロジェクト一覧表示
- プロジェクト進捗概要
- 遅れ発生プロジェクトの強調表示
- プロジェクト検索・フィルタ機能

### 4.3 タスク管理機能

#### 4.3.1 タスク情報構成
- **基本情報**:
  - タスク名（必須）
  - 開始予定日（yyyy-mm-dd）
  - 終了予定日（yyyy-mm-dd）
  - 実績開始日（yyyy-mm-dd）
  - 実績終了日（yyyy-mm-dd）
  - 担当者（複数選択可能）
  - 優先度（高/中/低）
  - ステータス（未開始/進行中/完了/保留）
  - マイルストーンフラグ

- **関連情報**:
  - 先行タスク（複数設定可能）
  - 後続タスク（複数設定可能）
  - 親タスク（サブタスク階層管理）
  - タスクカテゴリ

- **工数管理**:
  - 予定工数（時間）
  - 実績工数（時間）
  - 進捗率（%）

- **追加機能**:
  - コメント・メモ
  - 添付ファイル（複数対応）

#### 4.3.2 タスク作成・編集機能
- タスク情報の新規作成
- 既存タスクの編集
- サブタスクの作成（無制限階層）
- タスクの複製機能
- タスクの削除機能（依存関係チェック付き）

#### 4.3.3 タスク一覧機能
- プロジェクト別タスク一覧表示
- 検索・フィルタ機能:
  - 担当者別
  - ステータス別
  - 優先度別
  - カテゴリ別
  - 期間指定
- ソート機能（各項目昇順・降順）
- 一括操作機能

### 4.4 ガントチャート機能

#### 4.4.1 基本表示機能
- カレンダー形式でのタスク表示
- タスクバーによる期間表示
- マイルストーン表示
- サブタスクの折りたたみ・展開
- ズーム機能（日/週/月単位）

#### 4.4.2 依存関係表示
- 先行・後続タスクを矢印で接続
- 依存関係の種類表示
- クリティカルパスの強調表示

#### 4.4.3 イナズマ線機能
- **表示切替**: ON/OFF可能
- **色分け**:
  - 遅れ: 赤色実線
  - 順調: 青色/緑色実線
  - 予定線: 破線
- **基準日設定**: 任意の日付を基準として設定可能

#### 4.4.4 インタラクティブ機能
- ドラッグ&ドロップによる日程変更
- タスクバーのリサイズによる期間変更
- タスククリックで詳細表示
- 右クリックメニュー

### 4.5 テンプレート機能

#### 4.5.1 テンプレート作成
- 既存プロジェクトからのテンプレート化
- 含める情報:
  - タスク名
  - 期間の相対的関係
  - タスク階層構造
  - 依存関係
  - カテゴリ情報

#### 4.5.2 テンプレート適用
- プロジェクトカテゴリによる手動選択
- タスク自動生成
- 生成後の編集・調整機能

### 4.6 通知機能

#### 4.6.1 アプリ内通知
- 期限アラート（タスク期限3日前、1日前、当日）
- 進捗遅れ通知
- 新規タスク割り当て通知
- コメント・更新通知

#### 4.6.2 メール通知
- 通知設定の個人カスタマイズ
- 期限アラートメール
- 進捗レポートメール（週次/月次）

### 4.7 レポート・出力機能

#### 4.7.1 進捗レポート
- プロジェクト進捗サマリー
- タスク完了率
- 工数実績vs予定
- 遅延タスク一覧
- 定期自動配信機能

#### 4.7.2 エクスポート機能
- ガントチャートPDF出力
- タスク一覧Excel出力
- 進捗レポートPDF出力
- カスタムレポート作成

### 4.8 その他機能

#### 4.8.1 カテゴリ管理
- タスクカテゴリの作成・編集・削除
- プロジェクトカテゴリの管理
- カテゴリ別の色分け設定

#### 4.8.2 システム設定
- 通知設定
- 表示設定
- データバックアップ
- ユーザーアクティビティログ

## 5. 画面要件

### 5.1 画面一覧
1. **ログイン画面**
2. **ダッシュボード**
3. **ユーザー管理画面（管理者用）**
4. **プロフィール編集画面**
5. **プロジェクト一覧画面**
6. **プロジェクト作成画面**
7. **プロジェクト詳細画面**
8. **タスク一覧画面**
9. **タスク作成・編集画面**
10. **タスク詳細画面**
11. **ガントチャート画面**
12. **レポート画面**
13. **設定画面**

### 5.2 画面遷移要件
- 直感的なナビゲーション
- パンくずリスト表示
- 前画面への戻り機能
- ショートカットキー対応

## 6. データ要件

### 6.1 主要エンティティ
- **Users（ユーザー）**
- **Projects（プロジェクト）**
- **Tasks（タスク）**
- **TaskCategories（タスクカテゴリ）**
- **ProjectMembers（プロジェクトメンバー）**
- **TaskAssignments（タスク割り当て）**
- **TaskDependencies（タスク依存関係）**
- **TaskComments（タスクコメント）**
- **TaskAttachments（タスク添付ファイル）**
- **Notifications（通知）**
- **ProjectTemplates（プロジェクトテンプレート）**

### 6.2 データ保持期間
- ユーザーデータ: 永続保持
- プロジェクトデータ: 完了後2年間
- ログデータ: 1年間
- 添付ファイル: プロジェクト終了後1年間

## 7. セキュリティ要件

### 7.1 認証・認可
- パスワードハッシュ化（bcrypt）
- セッションベース認証
- CSRF対策
- 権限レベル別アクセス制御

### 7.2 データ保護
- 入力値検証・サニタイゼーション
- SQLインジェクション対策
- ファイルアップロード制限
- 個人情報保護

## 8. パフォーマンス要件

### 8.1 応答時間
- 一般的な操作: 2秒以内
- ガントチャート表示: 5秒以内
- レポート生成: 10秒以内

### 8.2 同時利用者数
- 想定同時接続数: 100ユーザー
- データベースコネクション: プール管理

## 9. 制約条件

### 9.1 技術制約
- BFFアーキテクチャの採用
- PostgreSQLデータベースの使用
- POST通信のみの利用

### 9.2 運用制約
- Webブラウザでの利用
- インターネット環境必須
- 定期バックアップの実施

## 10. 今後の拡張可能性

### 10.1 機能拡張
- API連携機能
- モバイルアプリ対応
- 多言語対応
- カレンダーアプリ連携

### 10.2 技術拡張
- マイクロサービス化
- クラウド対応
- 機械学習による工数予測